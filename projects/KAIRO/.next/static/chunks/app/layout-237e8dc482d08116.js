(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7177],{1398:(e,t,r)=>{"use strict";r.d(t,{co:()=>c,nQ:()=>d,r_:()=>l,ux:()=>g});var o=r(2663),a=function(e){return e.VALIDATION="validation",e.NETWORK="network",e.AUTHENTICATION="authentication",e.TRADING="trading",e.COMPILATION="compilation",e.SYSTEM="system",e.USER_INPUT="user_input",e}({}),s=function(e){return e.LOW="low",e.MEDIUM="medium",e.HIGH="high",e.CRITICAL="critical",e}({});let n={validation:{showToast:!0,logToConsole:!1,logToService:!1,retryable:!1},network:{showToast:!0,logToConsole:!0,logToService:!0,retryable:!0},authentication:{showToast:!0,logToConsole:!0,logToService:!0,retryable:!1},trading:{showToast:!0,logToConsole:!0,logToService:!0,retryable:!0},compilation:{showToast:!1,logToConsole:!0,logToService:!1,retryable:!1},system:{showToast:!0,logToConsole:!0,logToService:!0,retryable:!1},user_input:{showToast:!0,logToConsole:!1,logToService:!1,retryable:!1}};class i{static getInstance(){return i.instance||(i.instance=new i),i.instance}handle(e,t,r){let o=this.normalizeError(e,t),a={...n[o.type],...r};return this.addToQueue(o),a.showToast&&this.showToast(o),a.logToConsole&&this.logToConsole(o),a.logToService&&this.logToService(o),o}normalizeError(e,t){return"string"==typeof e?{type:"system",severity:"medium",message:e,timestamp:new Date,context:t}:e instanceof Error?{type:this.inferErrorType(e),severity:this.inferSeverity(e),message:e.message,details:{name:e.name,stack:e.stack},timestamp:new Date,context:t}:{...e,context:t||e.context}}inferErrorType(e){let t=e.message.toLowerCase(),r=e.name.toLowerCase();return t.includes("validation")||t.includes("required")||t.includes("invalid")?"validation":t.includes("network")||t.includes("fetch")||r.includes("network")?"network":t.includes("auth")||t.includes("token")||t.includes("unauthorized")?"authentication":t.includes("trade")||t.includes("order")||t.includes("position")?"trading":t.includes("compile")||t.includes("syntax")||t.includes("parse")?"compilation":"system"}inferSeverity(e){let t=e.message.toLowerCase();return t.includes("critical")||t.includes("fatal")?"critical":t.includes("failed")||t.includes("error")?"high":t.includes("warning")||t.includes("deprecated")?"medium":"low"}showToast(e){let t=this.formatUserMessage(e);switch(e.severity){case"critical":o.oR.error(t,{duration:8e3});break;case"high":o.oR.error(t,{duration:6e3});break;case"medium":(0,o.oR)(t,{icon:"⚠️",duration:4e3});break;case"low":(0,o.oR)(t,{icon:"ℹ️",duration:3e3})}}formatUserMessage(e){switch(e.type){case"validation":return e.message;case"network":return"Network error. Please check your connection and try again.";case"authentication":return"Authentication failed. Please log in again.";case"trading":return"Trading error: ".concat(e.message);case"compilation":return"Compilation error: ".concat(e.message);default:return"An unexpected error occurred. Please try again."}}logToConsole(e){("critical"===e.severity||"high"===e.severity?console.error:console.warn)("[".concat(e.type.toUpperCase(),"] ").concat(e.message),{severity:e.severity,timestamp:e.timestamp,context:e.context,details:e.details})}logToService(e){console.log("Would log to external service:",e)}addToQueue(e){this.errorQueue.push(e),this.errorQueue.length>this.maxQueueSize&&this.errorQueue.shift()}getRecentErrors(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this.errorQueue.slice(-e)}clearErrors(){this.errorQueue=[]}getErrorStats(){let e={total:this.errorQueue.length,byType:{},bySeverity:{}};return Object.values(a).forEach(t=>{e.byType[t]=0}),Object.values(s).forEach(t=>{e.bySeverity[t]=0}),this.errorQueue.forEach(t=>{e.byType[t.type]++,e.bySeverity[t.severity]++}),e}constructor(){this.errorQueue=[],this.maxQueueSize=100}}let l=i.getInstance(),c=(e,t)=>l.handle({type:"validation",severity:"medium",message:e,timestamp:new Date},t),d=(e,t)=>l.handle(e,t,{showToast:!0,logToConsole:!0,logToService:!0}),u=(e,t,r)=>l.handle({type:"trading",severity:"high",message:e,details:t,timestamp:new Date},r),h=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"error";return l.handle({type:"compilation",severity:"error"===r?"high":"medium",message:"Line ".concat(e,": ").concat(t),details:{line:e,type:r},timestamp:new Date},"Pine Script Compilation")},g=()=>({handleError:(e,t)=>l.handle(e,t),handleValidationError:c,handleNetworkError:d,handleTradingError:u,handleCompilationError:h,getRecentErrors:()=>l.getRecentErrors(),getErrorStats:()=>l.getErrorStats(),clearErrors:()=>l.clearErrors()})},3673:()=>{},5380:(e,t,r)=>{"use strict";r.d(t,{As:()=>c,OJ:()=>l});var o=r(5155),a=r(2115),s=r(5125),n=r(2663);let i=(0,a.createContext)(void 0);s.A.defaults.baseURL="".concat("http://localhost:3001","/api"),s.A.interceptors.request.use(e=>{let t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),s.A.interceptors.response.use(e=>e,async e=>{var t;let r=e.config;if((null==(t=e.response)?void 0:t.status)===401&&!r._retry){r._retry=!0;try{let e=localStorage.getItem("refreshToken");if(e){let{token:t}=(await s.A.post("/auth/refresh",{refreshToken:e})).data.data;return localStorage.setItem("token",t),r.headers.Authorization="Bearer ".concat(t),(0,s.A)(r)}}catch(e){localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),window.location.href="/login"}}return Promise.reject(e)});let l=e=>{let{children:t}=e,[r,l]=(0,a.useState)(null),[c,d]=(0,a.useState)(!0);(0,a.useEffect)(()=>{(async()=>{if(localStorage.getItem("token"))try{let e=await s.A.get("/auth/me");l(e.data.data.user)}catch(e){localStorage.removeItem("token"),localStorage.removeItem("refreshToken")}d(!1)})()},[]);let u=async(e,t)=>{try{let{user:r,accessToken:o,refreshToken:a}=(await s.A.post("/auth/login",{email:e,password:t})).data.data;localStorage.setItem("token",o),localStorage.setItem("refreshToken",a),l(r),n.oR.success("Login successful!")}catch(t){var r,o;let e=(null==(o=t.response)||null==(r=o.data)?void 0:r.message)||"Login failed";throw n.oR.error(e),t}},h=async e=>{try{let{user:t,accessToken:r,refreshToken:o}=(await s.A.post("/auth/register",e)).data.data;localStorage.setItem("token",r),localStorage.setItem("refreshToken",o),l(t),n.oR.success("Registration successful!")}catch(o){var t,r;let e=(null==(r=o.response)||null==(t=r.data)?void 0:t.message)||"Registration failed";throw n.oR.error(e),o}},g=()=>{localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),l(null),n.oR.success("Logged out successfully")},m=async e=>{try{let t=await s.A.put("/auth/profile",e);l(t.data.data.user),n.oR.success("Profile updated successfully!")}catch(o){var t,r;let e=(null==(r=o.response)||null==(t=r.data)?void 0:t.message)||"Profile update failed";throw n.oR.error(e),o}},y=async()=>{try{let e=localStorage.getItem("refreshToken");if(!e)throw Error("No refresh token");let{token:t}=(await s.A.post("/auth/refresh",{refreshToken:e})).data.data;localStorage.setItem("token",t)}catch(e){throw g(),e}};return(0,o.jsx)(i.Provider,{value:{user:r,loading:c,login:u,register:h,logout:g,updateProfile:m,refreshToken:y},children:t})},c=()=>{let e=(0,a.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},5485:(e,t,r)=>{"use strict";r.d(t,{DP:()=>i,NP:()=>n});var o=r(5155),a=r(2115);let s=(0,a.createContext)(void 0),n=e=>{let{children:t}=e,[r,n]=(0,a.useState)("light"),[i,l]=(0,a.useState)(!1);if((0,a.useEffect)(()=>{l(!0);let e=localStorage.getItem("theme"),t=window.matchMedia("(prefers-color-scheme: dark)").matches,r=e||(t?"dark":"light");n(r),"undefined"!=typeof document&&document.documentElement.classList.toggle("dark","dark"===r)},[]),!i)return(0,o.jsx)(o.Fragment,{children:t});let c=e=>{n(e),localStorage.setItem("theme",e),"undefined"!=typeof document&&document.documentElement.classList.toggle("dark","dark"===e)};return(0,o.jsx)(s.Provider,{value:{theme:r,toggleTheme:()=>{c("light"===r?"dark":"light")},setTheme:c},children:t})},i=()=>{let e=(0,a.useContext)(s);return void 0===e?{theme:"light",toggleTheme:()=>{},setTheme:()=>{}}:e}},6992:(e,t,r)=>{"use strict";r.d(t,{u:()=>i,y:()=>n});var o=r(5155),a=r(2115);let s=(0,a.createContext)(void 0);function n(e){let{children:t}=e,[r,n]=(0,a.useState)(null),[i,l]=(0,a.useState)([]),[c,d]=(0,a.useState)(!0),[u,h]=(0,a.useState)(null),g=async()=>{try{d(!0),h(null);let e=localStorage.getItem("token");if(!e)throw Error("No authentication token found");let t=await fetch("/api/brokers/accounts",{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!t.ok)throw Error("Failed to fetch broker accounts");let o=await t.json();if(o.success)l(o.data||[]),r&&(o.data.find(e=>e.id===r.id)||n(null)),!r&&o.data.length>0&&n(o.data[0]);else throw Error(o.message||"Failed to fetch accounts")}catch(e){console.error("Error fetching broker accounts:",e),h(e instanceof Error?e.message:"Failed to load accounts"),l([])}finally{d(!1)}},m=async()=>{await g()};return(0,a.useEffect)(()=>{g()},[g]),(0,a.useEffect)(()=>{r?localStorage.setItem("selectedBrokerAccount",JSON.stringify(r)):localStorage.removeItem("selectedBrokerAccount")},[r]),(0,a.useEffect)(()=>{let e=localStorage.getItem("selectedBrokerAccount");if(e)try{let t=JSON.parse(e);n(t)}catch(e){console.error("Error parsing saved broker account:",e),localStorage.removeItem("selectedBrokerAccount")}},[]),(0,o.jsx)(s.Provider,{value:{selectedAccount:r,setSelectedAccount:n,accounts:i,loading:c,error:u,refreshAccounts:m},children:t})}function i(){let e=(0,a.useContext)(s);if(void 0===e)throw Error("useBrokerAccount must be used within a BrokerAccountProvider");return e}},7088:(e,t,r)=>{"use strict";r.d(t,{default:()=>d});var o=r(5155),a=r(2115),s=r(1398),n=r(9582),i=r(9559),l=r(1712);class c extends a.Component{static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){this.setState({errorInfo:t}),s.r_.handle(e,"ErrorBoundary"),this.props.onError&&this.props.onError(e,t)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:(0,o.jsx)("div",{className:"min-h-screen flex items-center justify-center p-4 bg-gray-50 dark:bg-gray-900",children:(0,o.jsxs)("div",{className:"w-full max-w-md bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700",children:[(0,o.jsxs)("div",{className:"p-6 text-center",children:[(0,o.jsx)("div",{className:"mx-auto mb-4 w-12 h-12 bg-red-100 dark:bg-red-900/20 rounded-full flex items-center justify-center",children:(0,o.jsx)(n.A,{className:"w-6 h-6 text-red-600 dark:text-red-400"})}),(0,o.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Oops! Something went wrong"})]}),(0,o.jsxs)("div",{className:"px-6 pb-6 space-y-4",children:[(0,o.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 text-center",children:"We encountered an unexpected error. This has been logged and our team will look into it."}),!1,(0,o.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 pt-4",children:[(0,o.jsxs)("button",{onClick:this.handleRetry,className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors",children:[(0,o.jsx)(i.A,{className:"w-4 h-4"}),"Try Again"]}),(0,o.jsxs)("button",{onClick:this.handleGoHome,className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,o.jsx)(l.A,{className:"w-4 h-4"}),"Go Home"]})]})]})]})}):this.props.children}constructor(e){super(e),this.handleRetry=()=>{this.setState({hasError:!1,error:void 0,errorInfo:void 0})},this.handleGoHome=()=>{window.location.href="/dashboard"},this.state={hasError:!1}}}let d=c},7287:(e,t,r)=>{"use strict";r.d(t,{Providers:()=>g});var o=r(5155),a=r(2115),s=r(7067),n=r(9776),i=r(5380),l=r(5485),c=r(6992);let d=(0,a.createContext)(void 0);function u(e){let{children:t}=e,[r,s]=(0,a.useState)(!0);(0,a.useEffect)(()=>{let e=localStorage.getItem("tradingMode");e&&s("paper"===e)},[]),(0,a.useEffect)(()=>{localStorage.setItem("tradingMode",r?"paper":"live")},[r]);let n=r?"paper":"live";return(0,o.jsx)(d.Provider,{value:{isPaperTrading:r,setIsPaperTrading:s,tradingMode:n,toggleTradingMode:()=>{s(!r)}},children:t})}let h=new s.E({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:1,staleTime:3e5}}});function g(e){let{children:t}=e;return(0,o.jsx)(n.Ht,{client:h,children:(0,o.jsx)(l.NP,{children:(0,o.jsx)(i.OJ,{children:(0,o.jsx)(c.y,{children:(0,o.jsx)(u,{children:t})})})})})}},8567:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ChunkLoadErrorHandler:()=>a,default:()=>i,useChunkErrorHandler:()=>n,withChunkErrorHandling:()=>s});var o=r(1398);class a{static handleChunkError(e,t){let r=(null==e?void 0:e.message)||"Unknown chunk loading error";if(!(r.includes("ChunkLoadError")||r.includes("Loading chunk")||r.includes("Loading CSS chunk")))return o.r_.handle(e,"ChunkErrorHandler"),Promise.reject(e);let a=t||r,s=this.retryAttempts.get(a)||0;return s>=this.maxRetries?(o.r_.handle(e,"ChunkErrorHandler - Max Retries Reached"),this.retryAttempts.delete(a),window.location.reload(),Promise.reject(e)):(this.retryAttempts.set(a,s+1),o.r_.handle(e,"ChunkErrorHandler - Retry Attempt"),new Promise((e,r)=>{setTimeout(()=>{t&&this.clearChunkCache(t),e()},this.retryDelay*(s+1))}))}static clearChunkCache(e){try{if(window.__webpack_require__){let t=window.__webpack_require__;t.cache&&Object.keys(t.cache).forEach(r=>{r.includes(e)&&delete t.cache[r]}),t.installedChunks&&delete t.installedChunks[e]}}catch(e){console.warn("Failed to clear chunk cache:",e)}}static resetRetryCount(e){e?this.retryAttempts.delete(e):this.retryAttempts.clear()}static getRetryCount(e){return this.retryAttempts.get(e)||0}}function s(e){return function(){for(var t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];try{let t=e(...r);if(t&&"function"==typeof t.catch)return t.catch(e=>{if(e&&("ChunkLoadError"===e.name||e.message&&e.message.includes("Loading chunk")))return a.handleChunkError(e);throw e});return t}catch(e){if(e&&("ChunkLoadError"===e.name||e.message&&e.message.includes("Loading chunk")))return void a.handleChunkError(e);throw e}}}function n(){return{handleChunkError:a.handleChunkError,resetRetryCount:a.resetRetryCount,getRetryCount:a.getRetryCount}}a.retryAttempts=new Map,a.maxRetries=3,a.retryDelay=1e3,window.addEventListener("unhandledrejection",e=>{let t=e.reason;t&&("ChunkLoadError"===t.name||t.message&&t.message.includes("Loading chunk"))&&(e.preventDefault(),a.handleChunkError(t))}),window.addEventListener("error",e=>{let t=e.error;t&&("ChunkLoadError"===t.name||t.message&&t.message.includes("Loading chunk"))&&(e.preventDefault(),a.handleChunkError(t))});let i=a},9580:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,8963,23)),Promise.resolve().then(r.bind(r,2663)),Promise.resolve().then(r.t.bind(r,3673,23)),Promise.resolve().then(r.bind(r,7287)),Promise.resolve().then(r.bind(r,7088)),Promise.resolve().then(r.bind(r,8567))}},e=>{e.O(0,[557,2978,2663,5125,1992,8441,1255,7358],()=>e(e.s=9580)),_N_E=e.O()}]);