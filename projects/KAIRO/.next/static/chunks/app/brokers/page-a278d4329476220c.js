(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6387],{532:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(5105).A)("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]])},1016:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(5105).A)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},1078:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(5105).A)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},1360:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(5105).A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},5011:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>y});var a=r(5155),s=r(2115),o=r(5380),n=r(2663),c=r(1016),l=r(7816),i=r(1078),d=r(6191),u=r(9559),x=r(1360),m=r(532),h=r(7828);let g=(0,r(5105).A)("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);function y(){let{user:e}=(0,o.As)(),[t,r]=(0,s.useState)([]),[m,h]=(0,s.useState)([]),[g,y]=(0,s.useState)(!0),[p,k]=(0,s.useState)(!1),[f,v]=(0,s.useState)(null),[j,w]=(0,s.useState)(null),[N,A]=(0,s.useState)(null);(0,s.useEffect)(()=>{S(),C()},[]);let S=async()=>{try{let e=await fetch("/api/brokers/connections",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});if(e.ok){let t=await e.json();r(t.data)}else n.oR.error("Failed to fetch broker connections")}catch(e){console.error("Error fetching connections:",e),n.oR.error("Failed to fetch broker connections")}finally{y(!1)}},C=async()=>{try{let e=await fetch("/api/brokers/supported");if(e.ok){let t=await e.json();h(t.data)}}catch(e){console.error("Error fetching supported brokers:",e)}},I=async e=>{w(e);try{let t=await fetch("/api/brokers/connections/".concat(e,"/test"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}),r=await t.json();r.success?(n.oR.success("Connection test successful!"),S()):n.oR.error(r.error||"Connection test failed")}catch(e){console.error("Error testing connection:",e),n.oR.error("Failed to test connection")}finally{w(null)}},T=async e=>{A(e);try{let t=await fetch("/api/brokers/connections/".concat(e,"/sync"),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}),r=await t.json();r.success?(n.oR.success("Account data synced successfully!"),S()):n.oR.error(r.error||"Failed to sync account data")}catch(e){console.error("Error syncing account:",e),n.oR.error("Failed to sync account data")}finally{A(null)}},R=async(e,t)=>{try{let r=await fetch("/api/brokers/connections/".concat(e,"/status"),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({isActive:t})}),a=await r.json();a.success?(n.oR.success("Connection ".concat(t?"activated":"deactivated"," successfully")),S()):n.oR.error(a.error||"Failed to update connection status")}catch(e){console.error("Error updating connection status:",e),n.oR.error("Failed to update connection status")}},E=async e=>{if(confirm("Are you sure you want to delete this broker connection? This action cannot be undone."))try{let t=await fetch("/api/brokers/connections/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}),r=await t.json();r.success?(n.oR.success("Broker connection deleted successfully"),S()):n.oR.error(r.error||"Failed to delete connection")}catch(e){console.error("Error deleting connection:",e),n.oR.error("Failed to delete connection")}};return g?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsx)("div",{className:"mb-8",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Broker Connections"}),(0,a.jsx)("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"Connect your brokerage accounts to enable live trading and portfolio sync"})]}),(0,a.jsxs)("button",{onClick:()=>k(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,a.jsx)(d.A,{className:"h-4 w-4 mr-2"}),"Add Connection"]})]})}),0===t.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"mx-auto h-24 w-24 text-gray-400",children:(0,a.jsx)("svg",{fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),(0,a.jsx)("h3",{className:"mt-4 text-lg font-medium text-gray-900 dark:text-white",children:"No broker connections"}),(0,a.jsx)("p",{className:"mt-2 text-gray-500 dark:text-gray-400",children:"Connect your first brokerage account to start live trading"}),(0,a.jsxs)("button",{onClick:()=>k(!0),className:"mt-4 inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",children:[(0,a.jsx)(d.A,{className:"h-4 w-4 mr-2"}),"Add Your First Connection"]})]}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(e=>(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:e.isActive?e.isConnected?(0,a.jsx)(l.A,{className:"h-5 w-5 text-green-500"}):(0,a.jsx)(i.A,{className:"h-5 w-5 text-yellow-500"}):(0,a.jsx)(c.A,{className:"h-5 w-5 text-gray-400"})}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:e.accountName}),(0,a.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.brokerType})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("button",{onClick:()=>I(e.id),disabled:j===e.id,className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",title:"Test Connection",children:j===e.id?(0,a.jsx)(u.A,{className:"h-4 w-4 animate-spin"}):(0,a.jsx)(u.A,{className:"h-4 w-4"})}),(0,a.jsx)("button",{onClick:()=>E(e.id),className:"p-2 text-gray-400 hover:text-red-600 dark:hover:text-red-400",title:"Delete Connection",children:(0,a.jsx)(x.A,{className:"h-4 w-4"})})]})]}),(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"Status:"}),(0,a.jsx)("span",{className:"font-medium ".concat(e.isActive&&e.isConnected?"text-green-600 dark:text-green-400":e.isActive?"text-yellow-600 dark:text-yellow-400":"text-gray-600 dark:text-gray-400"),children:e.isActive?e.isConnected?"Connected":"Disconnected":"Inactive"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm mt-2",children:[(0,a.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"Environment:"}),(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("production"===e.environment?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200"),children:e.environment})]}),e.lastSyncAt&&(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm mt-2",children:[(0,a.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"Last Sync:"}),(0,a.jsx)("span",{className:"text-gray-900 dark:text-white",children:new Date(e.lastSyncAt).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]}),(0,a.jsxs)("div",{className:"mt-6 flex space-x-3",children:[(0,a.jsx)("button",{onClick:()=>R(e.id,!e.isActive),className:"flex-1 px-3 py-2 rounded-md text-sm font-medium ".concat(e.isActive?"bg-red-100 text-red-700 hover:bg-red-200 dark:bg-red-900 dark:text-red-200 dark:hover:bg-red-800":"bg-green-100 text-green-700 hover:bg-green-200 dark:bg-green-900 dark:text-green-200 dark:hover:bg-green-800"),children:e.isActive?"Deactivate":"Activate"}),(0,a.jsx)("button",{onClick:()=>T(e.id),disabled:!e.isActive||N===e.id,className:"flex-1 px-3 py-2 rounded-md text-sm font-medium bg-blue-100 text-blue-700 hover:bg-blue-200 dark:bg-blue-900 dark:text-blue-200 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed",children:N===e.id?(0,a.jsx)(u.A,{className:"h-4 w-4 animate-spin mx-auto"}):"Sync"})]})]},e.id))}),p&&(0,a.jsx)(b,{supportedBrokers:m,onClose:()=>{k(!1),v(null)},onSuccess:()=>{k(!1),v(null),S()}})]})})}function b(e){let{supportedBrokers:t,onClose:r,onSuccess:o}=e,[l,i]=(0,s.useState)("select"),[d,u]=(0,s.useState)(null),[x,y]=(0,s.useState)({accountName:"",apiKey:"",apiSecret:"",environment:"sandbox",accountId:"",accessToken:"",refreshToken:""}),[b,p]=(0,s.useState)(!1),[k,f]=(0,s.useState)(!1),v=async e=>{if(e.preventDefault(),d){f(!0);try{let e=await fetch("/api/brokers/connections",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({brokerType:d.type,accountName:x.accountName,credentials:{apiKey:x.apiKey,apiSecret:x.apiSecret,environment:x.environment,accountId:x.accountId||void 0,accessToken:x.accessToken||void 0,refreshToken:x.refreshToken||void 0}})}),t=await e.json();t.success?(n.oR.success("Broker connection created successfully!"),o()):n.oR.error(t.error||"Failed to create broker connection")}catch(e){console.error("Error creating connection:",e),n.oR.error("Failed to create broker connection")}finally{f(!1)}}};return(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"select"===l?"Select Broker":"Configure ".concat(null==d?void 0:d.name)}),(0,a.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:(0,a.jsx)(c.A,{className:"h-6 w-6"})})]}),"select"===l?(0,a.jsx)("div",{className:"space-y-4",children:t.map(e=>(0,a.jsxs)("div",{onClick:()=>{u(e),i("configure")},className:"p-4 border border-gray-200 dark:border-gray-700 rounded-lg cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-gray-100 dark:bg-gray-700 rounded-lg flex items-center justify-center mr-4",children:(0,a.jsx)("span",{className:"text-lg font-bold text-gray-600 dark:text-gray-300",children:e.name.charAt(0)})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:e.name}),(0,a.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.description})]})]}),(0,a.jsx)("div",{className:"flex items-center",children:e.isEnabled?(0,a.jsx)("span",{className:"px-2 py-1 bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200 rounded-full text-xs font-medium",children:"Available"}):(0,a.jsx)("span",{className:"px-2 py-1 bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200 rounded-full text-xs font-medium",children:"Coming Soon"})})]}),(0,a.jsxs)("div",{className:"mt-3 flex flex-wrap gap-2",children:[e.capabilities.supportsStocks&&(0,a.jsx)("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200 rounded text-xs",children:"Stocks"}),e.capabilities.supportsCrypto&&(0,a.jsx)("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200 rounded text-xs",children:"Crypto"}),e.capabilities.supportsOptions&&(0,a.jsx)("span",{className:"px-2 py-1 bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200 rounded text-xs",children:"Options"}),e.capabilities.supportsForex&&(0,a.jsx)("span",{className:"px-2 py-1 bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200 rounded text-xs",children:"Forex"})]})]},e.type))}):(0,a.jsxs)("form",{onSubmit:v,className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Account Name"}),(0,a.jsx)("input",{type:"text",value:x.accountName,onChange:e=>y({...x,accountName:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"My Trading Account",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Environment"}),(0,a.jsxs)("select",{value:x.environment,onChange:e=>y({...x,environment:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[(0,a.jsx)("option",{value:"sandbox",children:"Sandbox (Paper Trading)"}),(0,a.jsx)("option",{value:"production",children:"Production (Live Trading)"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"API Key"}),(0,a.jsx)("input",{type:"text",value:x.apiKey,onChange:e=>y({...x,apiKey:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Your API Key",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"API Secret"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:b?"text":"password",value:x.apiSecret,onChange:e=>y({...x,apiSecret:e.target.value}),className:"w-full px-3 py-2 pr-10 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Your API Secret",required:!0}),(0,a.jsx)("button",{type:"button",onClick:()=>p(!b),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:b?(0,a.jsx)(m.A,{className:"h-4 w-4 text-gray-400"}):(0,a.jsx)(h.A,{className:"h-4 w-4 text-gray-400"})})]})]}),(null==d?void 0:d.authConfig.requiresAccessToken)&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Access Token (Optional)"}),(0,a.jsx)("input",{type:"text",value:x.accessToken,onChange:e=>y({...x,accessToken:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Your Access Token"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Account ID (Optional)"}),(0,a.jsx)("input",{type:"text",value:x.accountId,onChange:e=>y({...x,accountId:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"Your Account ID"})]}),(0,a.jsx)("div",{className:"bg-blue-50 dark:bg-blue-900 p-4 rounded-md",children:(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)(g,{className:"h-5 w-5 text-blue-400"})}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-blue-800 dark:text-blue-200",children:"Need API credentials?"}),(0,a.jsx)("div",{className:"mt-2 text-sm text-blue-700 dark:text-blue-300",children:(0,a.jsxs)("p",{children:["Visit the"," ",(0,a.jsxs)("a",{href:null==d?void 0:d.authConfig.documentationUrl,target:"_blank",rel:"noopener noreferrer",className:"underline hover:text-blue-600 dark:hover:text-blue-200",children:[null==d?void 0:d.name," documentation"]})," ","to learn how to generate your API credentials."]})})]})]})}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("button",{type:"button",onClick:()=>i("select"),className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600",children:"Back"}),(0,a.jsx)("button",{type:"submit",disabled:k,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:k?"Creating...":"Create Connection"})]})]})]})})})}},5105:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var a=r(2115),s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let o=(e,t)=>{let r=(0,a.forwardRef)((r,o)=>{let{color:n="currentColor",size:c=24,strokeWidth:l=2,absoluteStrokeWidth:i,className:d="",children:u,...x}=r;return(0,a.createElement)("svg",{ref:o,...s,width:c,height:c,stroke:n,strokeWidth:i?24*Number(l)/Number(c):l,className:["lucide","lucide-".concat(e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim()),d].join(" "),...x},[...t.map(e=>{let[t,r]=e;return(0,a.createElement)(t,r)}),...Array.isArray(u)?u:[u]])});return r.displayName="".concat(e),r}},5380:(e,t,r)=>{"use strict";r.d(t,{As:()=>i,OJ:()=>l});var a=r(5155),s=r(2115),o=r(5125),n=r(2663);let c=(0,s.createContext)(void 0);o.A.defaults.baseURL="".concat("http://localhost:3001","/api"),o.A.interceptors.request.use(e=>{let t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),o.A.interceptors.response.use(e=>e,async e=>{var t;let r=e.config;if((null==(t=e.response)?void 0:t.status)===401&&!r._retry){r._retry=!0;try{let e=localStorage.getItem("refreshToken");if(e){let{token:t}=(await o.A.post("/auth/refresh",{refreshToken:e})).data.data;return localStorage.setItem("token",t),r.headers.Authorization="Bearer ".concat(t),(0,o.A)(r)}}catch(e){localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),window.location.href="/login"}}return Promise.reject(e)});let l=e=>{let{children:t}=e,[r,l]=(0,s.useState)(null),[i,d]=(0,s.useState)(!0);(0,s.useEffect)(()=>{(async()=>{if(localStorage.getItem("token"))try{let e=await o.A.get("/auth/me");l(e.data.data.user)}catch(e){localStorage.removeItem("token"),localStorage.removeItem("refreshToken")}d(!1)})()},[]);let u=async(e,t)=>{try{let{user:r,accessToken:a,refreshToken:s}=(await o.A.post("/auth/login",{email:e,password:t})).data.data;localStorage.setItem("token",a),localStorage.setItem("refreshToken",s),l(r),n.oR.success("Login successful!")}catch(t){var r,a;let e=(null==(a=t.response)||null==(r=a.data)?void 0:r.message)||"Login failed";throw n.oR.error(e),t}},x=async e=>{try{let{user:t,accessToken:r,refreshToken:a}=(await o.A.post("/auth/register",e)).data.data;localStorage.setItem("token",r),localStorage.setItem("refreshToken",a),l(t),n.oR.success("Registration successful!")}catch(a){var t,r;let e=(null==(r=a.response)||null==(t=r.data)?void 0:t.message)||"Registration failed";throw n.oR.error(e),a}},m=()=>{localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),l(null),n.oR.success("Logged out successfully")},h=async e=>{try{let t=await o.A.put("/auth/profile",e);l(t.data.data.user),n.oR.success("Profile updated successfully!")}catch(a){var t,r;let e=(null==(r=a.response)||null==(t=r.data)?void 0:t.message)||"Profile update failed";throw n.oR.error(e),a}},g=async()=>{try{let e=localStorage.getItem("refreshToken");if(!e)throw Error("No refresh token");let{token:t}=(await o.A.post("/auth/refresh",{refreshToken:e})).data.data;localStorage.setItem("token",t)}catch(e){throw m(),e}};return(0,a.jsx)(c.Provider,{value:{user:r,loading:i,login:u,register:x,logout:m,updateProfile:h,refreshToken:g},children:t})},i=()=>{let e=(0,s.useContext)(c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},6191:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(5105).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},7816:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(5105).A)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},7828:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(5105).A)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},8235:(e,t,r)=>{Promise.resolve().then(r.bind(r,5011))},9559:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(5105).A)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])}},e=>{e.O(0,[2663,5125,8441,1255,7358],()=>e(e.s=8235)),_N_E=e.O()}]);