(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6803],{233:(e,t,r)=>{Promise.resolve().then(r.bind(r,9944))},1078:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(5105).A)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},1398:(e,t,r)=>{"use strict";r.d(t,{co:()=>c,nQ:()=>d,r_:()=>o,ux:()=>m});var s=r(2663),a=function(e){return e.VALIDATION="validation",e.NETWORK="network",e.AUTHENTICATION="authentication",e.TRADING="trading",e.COMPILATION="compilation",e.SYSTEM="system",e.USER_INPUT="user_input",e}({}),l=function(e){return e.LOW="low",e.MEDIUM="medium",e.HIGH="high",e.CRITICAL="critical",e}({});let i={validation:{showToast:!0,logToConsole:!1,logToService:!1,retryable:!1},network:{showToast:!0,logToConsole:!0,logToService:!0,retryable:!0},authentication:{showToast:!0,logToConsole:!0,logToService:!0,retryable:!1},trading:{showToast:!0,logToConsole:!0,logToService:!0,retryable:!0},compilation:{showToast:!1,logToConsole:!0,logToService:!1,retryable:!1},system:{showToast:!0,logToConsole:!0,logToService:!0,retryable:!1},user_input:{showToast:!0,logToConsole:!1,logToService:!1,retryable:!1}};class n{static getInstance(){return n.instance||(n.instance=new n),n.instance}handle(e,t,r){let s=this.normalizeError(e,t),a={...i[s.type],...r};return this.addToQueue(s),a.showToast&&this.showToast(s),a.logToConsole&&this.logToConsole(s),a.logToService&&this.logToService(s),s}normalizeError(e,t){return"string"==typeof e?{type:"system",severity:"medium",message:e,timestamp:new Date,context:t}:e instanceof Error?{type:this.inferErrorType(e),severity:this.inferSeverity(e),message:e.message,details:{name:e.name,stack:e.stack},timestamp:new Date,context:t}:{...e,context:t||e.context}}inferErrorType(e){let t=e.message.toLowerCase(),r=e.name.toLowerCase();return t.includes("validation")||t.includes("required")||t.includes("invalid")?"validation":t.includes("network")||t.includes("fetch")||r.includes("network")?"network":t.includes("auth")||t.includes("token")||t.includes("unauthorized")?"authentication":t.includes("trade")||t.includes("order")||t.includes("position")?"trading":t.includes("compile")||t.includes("syntax")||t.includes("parse")?"compilation":"system"}inferSeverity(e){let t=e.message.toLowerCase();return t.includes("critical")||t.includes("fatal")?"critical":t.includes("failed")||t.includes("error")?"high":t.includes("warning")||t.includes("deprecated")?"medium":"low"}showToast(e){let t=this.formatUserMessage(e);switch(e.severity){case"critical":s.oR.error(t,{duration:8e3});break;case"high":s.oR.error(t,{duration:6e3});break;case"medium":(0,s.oR)(t,{icon:"⚠️",duration:4e3});break;case"low":(0,s.oR)(t,{icon:"ℹ️",duration:3e3})}}formatUserMessage(e){switch(e.type){case"validation":return e.message;case"network":return"Network error. Please check your connection and try again.";case"authentication":return"Authentication failed. Please log in again.";case"trading":return"Trading error: ".concat(e.message);case"compilation":return"Compilation error: ".concat(e.message);default:return"An unexpected error occurred. Please try again."}}logToConsole(e){("critical"===e.severity||"high"===e.severity?console.error:console.warn)("[".concat(e.type.toUpperCase(),"] ").concat(e.message),{severity:e.severity,timestamp:e.timestamp,context:e.context,details:e.details})}logToService(e){console.log("Would log to external service:",e)}addToQueue(e){this.errorQueue.push(e),this.errorQueue.length>this.maxQueueSize&&this.errorQueue.shift()}getRecentErrors(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this.errorQueue.slice(-e)}clearErrors(){this.errorQueue=[]}getErrorStats(){let e={total:this.errorQueue.length,byType:{},bySeverity:{}};return Object.values(a).forEach(t=>{e.byType[t]=0}),Object.values(l).forEach(t=>{e.bySeverity[t]=0}),this.errorQueue.forEach(t=>{e.byType[t.type]++,e.bySeverity[t.severity]++}),e}constructor(){this.errorQueue=[],this.maxQueueSize=100}}let o=n.getInstance(),c=(e,t)=>o.handle({type:"validation",severity:"medium",message:e,timestamp:new Date},t),d=(e,t)=>o.handle(e,t,{showToast:!0,logToConsole:!0,logToService:!0}),h=(e,t,r)=>o.handle({type:"trading",severity:"high",message:e,details:t,timestamp:new Date},r),g=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"error";return o.handle({type:"compilation",severity:"error"===r?"high":"medium",message:"Line ".concat(e,": ").concat(t),details:{line:e,type:r},timestamp:new Date},"Pine Script Compilation")},m=()=>({handleError:(e,t)=>o.handle(e,t),handleValidationError:c,handleNetworkError:d,handleTradingError:h,handleCompilationError:g,getRecentErrors:()=>o.getRecentErrors(),getErrorStats:()=>o.getErrorStats(),clearErrors:()=>o.clearErrors()})},1786:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(5105).A)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},5626:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(5105).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},5870:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(5105).A)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},5921:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(5105).A)("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]])},6046:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(5105).A)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]])},7816:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(5105).A)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},9602:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(5105).A)("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]])},9867:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(5105).A)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},9944:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>b});var s=r(5155),a=r(2115),l=r(7816),i=r(1078),n=r(5921),o=r(6046),c=r(9867),d=r(1786),h=r(5870),g=r(1398);let m=e=>{let{onSave:t,onRun:r,initialScript:m=""}=e,[u,x]=(0,a.useState)(m||'//@version=5\nstrategy("My Strategy", overlay=true, margin_long=100, margin_short=100)\n\n// Input parameters\nlength = input.int(14, title="Length")\nsource = input(close, title="Source")\n\n// Calculate indicators\nrsiValue = ta.rsi(source, length)\nsmaValue = ta.sma(source, length)\n\n// Entry conditions\nlongCondition = ta.crossover(rsiValue, 30)\nshortCondition = ta.crossunder(rsiValue, 70)\n\n// Strategy entries\nif (longCondition)\n    strategy.entry("Long", strategy.long)\n\nif (shortCondition)\n    strategy.entry("Short", strategy.short)\n\n// Plot indicators\nplot(smaValue, color=color.blue, title="SMA")\nhline(70, "Overbought", color=color.red)\nhline(30, "Oversold", color=color.green)\n\n// Plot RSI in separate pane\nrsiPlot = plot(rsiValue, title="RSI", color=color.purple)\nhline(50, "Midline", color=color.gray)'),[y,p]=(0,a.useState)([]),[v,b]=(0,a.useState)(!1),{handleCompilationError:f}=(0,g.ux)(),[k,w]=(0,a.useState)([]),[j,N]=(0,a.useState)(!1),S=(0,a.useRef)(null),T=(0,a.useRef)(null),C=e=>{b(!0);let t=[];e.split("\n").forEach((e,r)=>{let s=r+1,a=e.trim();a&&!a.startsWith("//")&&(1!==s||a.includes("@version")||t.push({line:s,message:"Missing @version declaration at the beginning",type:"error"}),(e.match(/\(/g)||[]).length!==(e.match(/\)/g)||[]).length&&t.push({line:s,message:"Unmatched parentheses",type:"error"}),e.includes("security(")&&!e.includes("request.security(")&&t.push({line:s,message:"security() is deprecated, use request.security() instead",type:"warning"}))}),t.forEach(e=>{f(e.line,e.message,e.type)}),p(t),b(!1)};return(0,a.useEffect)(()=>{C(u)},[]),(0,s.jsxs)("div",{className:"flex flex-col h-full bg-white dark:bg-gray-900",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Pine Script Editor"}),(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[0===y.filter(e=>"error"===e.type).length?(0,s.jsx)(l.A,{className:"h-4 w-4 text-green-500"}):(0,s.jsx)(i.A,{className:"h-4 w-4 text-red-500"}),(0,s.jsxs)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[y.filter(e=>"error"===e.type).length," errors,"," ",y.filter(e=>"warning"===e.type).length," warnings"]})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsxs)("button",{onClick:()=>{0===y.filter(e=>"error"===e.type).length?null==r||r(u):alert("Please fix all errors before running the script.")},disabled:y.filter(e=>"error"===e.type).length>0,className:"flex items-center px-3 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed",children:[(0,s.jsx)(n.A,{className:"h-4 w-4 mr-1"}),"Run"]}),(0,s.jsxs)("button",{onClick:()=>{let e=prompt("Enter script name:");if(e){let r={name:e,script:u};w(e=>[...e,r]),null==t||t(u)}},className:"flex items-center px-3 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[(0,s.jsx)(o.A,{className:"h-4 w-4 mr-1"}),"Save"]}),(0,s.jsxs)("button",{onClick:()=>{let e=new Blob([u],{type:"text/plain"}),t=URL.createObjectURL(e),r=document.createElement("a");r.href=t,r.download="pine_script.pine",r.click(),URL.revokeObjectURL(t)},className:"flex items-center px-3 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700",children:[(0,s.jsx)(c.A,{className:"h-4 w-4 mr-1"}),"Export"]}),(0,s.jsxs)("button",{onClick:()=>{var e;return null==(e=T.current)?void 0:e.click()},className:"flex items-center px-3 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700",children:[(0,s.jsx)(d.A,{className:"h-4 w-4 mr-1"}),"Import"]}),(0,s.jsx)("button",{onClick:()=>N(!j),className:"flex items-center px-3 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700",children:(0,s.jsx)(h.A,{className:"h-4 w-4"})})]})]}),(0,s.jsxs)("div",{className:"flex flex-1 overflow-hidden",children:[(0,s.jsxs)("div",{className:"flex-1 flex",children:[(0,s.jsx)("div",{className:"bg-gray-50 dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 py-4 px-2",children:u.split("\n").map((e,t)=>(0,s.jsx)("div",{className:"text-gray-500 text-sm pr-2 text-right select-none",children:t+1},t))}),(0,s.jsx)("div",{className:"flex-1 relative",children:(0,s.jsx)("textarea",{ref:S,value:u,onChange:e=>{let t=e.target.value;x(t),setTimeout(()=>C(t),500)},className:"w-full h-full p-4 font-mono text-sm bg-white dark:bg-gray-900 text-gray-900 dark:text-white border-none outline-none resize-none",placeholder:"Enter your Pine Script code here...",spellCheck:!1})})]}),j&&(0,s.jsx)("div",{className:"w-80 border-l border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800",children:(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Settings & Saved Scripts"}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Saved Scripts"}),(0,s.jsx)("div",{className:"space-y-2",children:k.map((e,t)=>(0,s.jsxs)("button",{onClick:()=>(e=>{x(e.script),C(e.script)})(e),className:"w-full text-left p-2 bg-white dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600",children:[(0,s.jsx)("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:e.name}),(0,s.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:[e.script.substring(0,50),"..."]})]},t))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Editor Settings"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("label",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",className:"mr-2",defaultChecked:!0}),(0,s.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Auto-validation"})]}),(0,s.jsxs)("label",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",className:"mr-2",defaultChecked:!0}),(0,s.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Line numbers"})]}),(0,s.jsxs)("label",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",className:"mr-2"}),(0,s.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Word wrap"})]})]})]})]})})]}),y.length>0&&(0,s.jsx)("div",{className:"border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 max-h-40 overflow-y-auto",children:(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Validation Results"}),(0,s.jsx)("div",{className:"space-y-1",children:y.map((e,t)=>(0,s.jsxs)("div",{className:"text-sm p-2 rounded ".concat("error"===e.type?"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400"),children:[(0,s.jsxs)("span",{className:"font-medium",children:["Line ",e.line,":"]})," ",e.message]},t))})]})}),(0,s.jsx)("input",{ref:T,type:"file",accept:".pine,.txt",onChange:e=>{var t;let r=null==(t=e.target.files)?void 0:t[0];if(r){let e=new FileReader;e.onload=e=>{var t;let r=null==(t=e.target)?void 0:t.result;x(r),C(r)},e.readAsText(r)}},className:"hidden"})]})};var u=r(5626),x=r(9602),y=r(2619),p=r.n(y),v=r(2663);function b(){let[e,t]=(0,a.useState)(!1),[r,l]=(0,a.useState)(!1),i=async e=>{t(!0);try{await new Promise(e=>setTimeout(e,1e3)),v.oR.success("Pine Script saved successfully!")}catch(e){v.oR.error("Failed to save Pine Script")}finally{t(!1)}},n=async e=>{l(!0);try{await new Promise(e=>setTimeout(e,2e3)),v.oR.success("Pine Script executed successfully!")}catch(e){v.oR.error("Failed to execute Pine Script")}finally{l(!1)}};return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[(0,s.jsx)("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)(p(),{href:"/trading",className:"flex items-center space-x-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors",children:[(0,s.jsx)(u.A,{className:"h-5 w-5"}),(0,s.jsx)("span",{children:"Back to Trading"})]}),(0,s.jsx)("div",{className:"h-6 w-px bg-gray-300 dark:bg-gray-600"}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(x.A,{className:"h-6 w-6 text-blue-600"}),(0,s.jsx)("h1",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Pine Script Editor"})]})]}),(0,s.jsx)("div",{className:"flex items-center space-x-3",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[e&&(0,s.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-500 dark:text-gray-400",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),(0,s.jsx)("span",{children:"Saving..."})]}),r&&(0,s.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-500 dark:text-gray-400",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-green-600"}),(0,s.jsx)("span",{children:"Running..."})]})]})})]})})}),(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,s.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden",children:(0,s.jsx)(m,{onSave:i,onRun:n})})})]})}}},e=>{e.O(0,[2663,6139,8441,1255,7358],()=>e(e.s=233)),_N_E=e.O()}]);